import{r as a,j as e}from"./react-COngqpYU.js";import{g as b,e as Y,f as z,h as W,i as H,j as G,r as K,k as Z,l as X,m as q,n as $,o as VV,p as AV,c as k,P as eV,B as F,q as sV,I as tV,t as nV,S as aV,C as oV,L as rV,v as iV,w as cV}from"./main-CxjcYnv4.js";import"./react-dom-_DKxCR66.js";import{l as lV}from"./socket.io-client-DFi9RC7o.js";import{B as f}from"./react-toastify-Dgo1EQhQ.js";import"./redux-persist-Wkwerb9j.js";import{m as dV,e as uV,n as gV,o as mV,p as hV}from"./react-icons-CBB84BlQ.js";import{u as v,a as x}from"./react-redux-CcH78hH7.js";import{u as pV}from"./react-i18next-CUyjTYQ-.js";import{v as fV}from"./uuid-DvF23Exx.js";import"./cross-fetch-DgOHDuhQ.js";import"./@reduxjs-CbK-fFGA.js";import"./redux-DITMfSWq.js";import"./immer-fBqQtvEc.js";import"./redux-thunk-ClJT1hhx.js";import"./reselect-B67fBsCs.js";import"./axios-B4uVmeYG.js";import"./react-router-dom-D1CrZXUE.js";import"./react-router-CmyMnZLT.js";import"./@remix-run-B-RBrVrq.js";import"./framer-motion-tubqN5b_.js";import"./react-hook-form-C_ktJAhU.js";import"./date-fns-cwXK75ha.js";import"./@vercel-Y_7pN-LL.js";/* empty css                             */import"./i18next-CIEwNdMy.js";import"./i18next-browser-languagedetector-RoqpcJAD.js";import"./i18next-http-backend-BZp8l2nN.js";import"./scheduler-CzFDRTuY.js";import"./clsx-B-dksMZM.js";import"./engine.io-client-DBBxzneW.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./use-sync-external-store-LSTNFSE1.js";var T=(V=>(V.USER="user",V.ADMIN="admin",V))(T||{});const CV="data:audio/mpeg;base64,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VVVVVVVVBAkAADPyO0qR06Jq1ZpnqdKeqONAw5TaDZx2n6gJxq8tx1VlvNymW4Sqmy7VyONQEqSrVjCj2ZjUlUlVeM3xm9VVaJVYBCvjN0KTdLUmY/ZtVhrr0maNAI1L/+l8a/GpazUmO7fs1Exv+tFJZr/0jZZdRRmJIjhHAA5g54JyMCskR6msIKVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5Jkg4/0LGnEQyNt8gAADSAAAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",EV=V=>{new Audio(V).play()},LV=b(),IV=({userName:V,connectSocket:A})=>{const r=a.useRef(null);return a.useEffect(()=>{if(A){const n=lV(LV.apiServerUrl);return r.current=n,n.emit("join",{userName:V}),()=>{n.emit("leave",{userName:V}),n.disconnect(),n.off()}}},[V,A]),r.current},xV=()=>{const V=v(),A=x(t=>t.messages.messages),r=a.useCallback(t=>V(Y(t)),[V]),n=a.useCallback(t=>V(z(t)),[V]);return{messages:A,setNewMessages:n,addNewMessage:r}},jV=()=>{const V=v(),A=x(s=>s.userAuth.name),r=x(s=>s.userAuth.joined),n=x(s=>s.userAuth.userId),t=a.useCallback(s=>V(W(s)),[V]),l=a.useCallback(s=>V(H(s)),[V]),o=a.useCallback(s=>V(G(s)),[V]),i=a.useCallback(()=>V(K()),[V]);return{userName:A,userId:n,isJoined:r,setUserName:t,setJoinedUser:l,setUserId:o,onLeave:i}},SV=({skipFetchUsersList:V,userId:A})=>{const[r,n]=a.useState(null),{t}=pV(),{onLeave:l}=jV(),{messages:o,setNewMessages:i,addNewMessage:s}=xV(),[c,{isLoading:g}]=Z(),[u,{isLoading:j}]=X(),[C,{isLoading:E}]=q(),[h,{data:L,isLoading:S,isFetching:w}]=$(),{data:D,refetch:p}=VV(void 0,{skip:V}),{data:U,isLoading:B,isFetching:M,isError:y,refetch:R}=AV({userId:A},{skip:!(A!=null&&A.length)}),d=a.useCallback(async I=>{n(I);try{await h({userId:I.userId}).unwrap()}catch{f.error(t("toast.error.FAILED_GET_MESSAGES"))}},[h,t]),_=a.useCallback(async I=>{try{await c({userId:I.userId}).unwrap(),p(),i([]),n(null),f.success(t("toast.success.SUCCESS_DELETE_USER"))}catch{f.error(t("toast.error.FAILED_DELETE_USER"))}},[c,p,i,t]),Q=a.useCallback(async()=>{try{await u({userId:A}).unwrap(),l(),i([])}catch{f.error(t("toast.error.FAILED_DELETE_CHAT"))}},[u,l,i,t,A]),J=a.useCallback(async()=>{try{await C({userId:A}).unwrap(),i([])}catch{f.error(t("toast.error.FAILED_DELETE_CHAT_HISTORY"))}},[C,i,t,A]),N=()=>n(null);return{selectedUser:r,messages:o,usersList:D,userById:L,userMessages:U,isLoadingUserById:S,isFetchingUserById:w,isLoadingMessages:B,isFetchingMessages:M,isErrorMessages:y,isLoadingDelete:g,isLoadingDeleteChat:j,isLoadingDeleteChatHistory:E,onDeleteChatHistory:J,deleteChat:u,onLeave:l,onDeleteChat:Q,setNewMessages:i,addNewMessage:s,onSelectUser:d,onDeleteUser:_,refetchUsers:()=>{N(),p()},onResetSelectedUser:N,deleteUser:c,refetchUserById:R,getUserById:h,refetchUsersList:p}},wV=({dependencies:V})=>{const A=a.useRef(null);return a.useEffect(()=>{A.current&&(A.current.scrollTop=A.current.scrollHeight)},V),{messagesContainerRef:A}},DV=({dependencies:V=[]})=>{const A=a.useRef(null);return a.useEffect(()=>{A.current&&(A.current.style.height="auto",A.current.style.height=`${A.current.scrollHeight}px`)},V),{textareaRef:A}},UV=({socket:V,sender:A,receiver:r})=>{const[n,t]=a.useState(""),l=c=>t(c.target.value),o=async c=>{if(c.preventDefault(),!!V&&n.trim()){const g={sender:A,receiver:r,text:n,timestamp:new Date().toISOString(),messageId:fV()};V.emit("send_message",g),EV(CV),t("")}},i=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),o(c))},s=!n.trim();return{onSendMessage:o,handleKeyDown:i,setTextareaContent:t,handleChangeTextArea:l,textareaContent:n,isDisabledButton:s}},BV="_userList_gbbxz_1",MV="_openUsersList_gbbxz_9",yV="_item_gbbxz_27",RV="_active_gbbxz_45",kV="_userName_gbbxz_59",OV="_disabled_gbbxz_67",FV="_controlButtons_gbbxz_77",m={userList:BV,openUsersList:MV,item:yV,active:RV,userName:kV,disabled:OV,controlButtons:FV},TV=({usersList:V,selectedUser:A,isOpenUsersList:r,onSelectUser:n,onDeleteUser:t,onResetSelectedUser:l})=>e.jsx("ul",{className:k(m.userList,r&&m.openUsersList),children:V==null?void 0:V.map(o=>e.jsxs("li",{className:k(m.item,A===o&&m.active),children:[e.jsx(eV,{className:k(m.userName,A===o&&m.disabled),onClick:()=>n(o),children:o==null?void 0:o.userName}),A===o&&e.jsxs("div",{className:m.controlButtons,children:[e.jsx(F,{icon:e.jsx(dV,{}),onClick:()=>t(o)}),e.jsx(F,{icon:e.jsx(uV,{}),onClick:l})]})]},o==null?void 0:o.userId))}),NV="_footerChat_q1ch9_1",PV={footerChat:NV},vV=({socket:V,receiver:A})=>{const{onSendMessage:r,handleKeyDown:n,handleChangeTextArea:t,textareaContent:l,isDisabledButton:o}=UV({socket:V,sender:T.ADMIN,receiver:A}),{textareaRef:i}=DV({dependencies:[l]});return e.jsxs("form",{onSubmit:r,className:PV.footerChat,children:[e.jsx(sV,{ref:i,value:l,onChange:t,onKeyDown:n,placeholder:"Type text",rows:1}),e.jsx(F,{icon:e.jsx(gV,{}),isDisabled:o})]})},_V="_authContainer_8d2dq_1",QV="_auth_8d2dq_1",P={authContainer:_V,auth:QV},JV=({value:V,onLogin:A,onChangePass:r})=>{const n=!!V.length;return e.jsx("div",{className:P.authContainer,children:e.jsxs("form",{onSubmit:A,className:P.auth,children:[e.jsx(tV,{id:"input-password",name:"password",type:"password",value:V,placeholder:"password",onChange:r}),n&&e.jsx(nV,{disabled:!V.length,children:"Log in"})]})})},bV="_inner_gtfkg_1",YV="_headButtons_gtfkg_17",zV="_chat_gtfkg_33",O={inner:bV,headButtons:YV,chat:zV};var WV={BASE_URL:"/portfolio/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const HV=()=>{const V=WV.VITE_ADMIN_PASS,[A,r]=a.useState(""),[n,t]=a.useState(!1),[l,o]=a.useState(!1),i=IV({userName:T.ADMIN,connectSocket:n}),{selectedUser:s,messages:c,usersList:g,userById:u,isLoadingUserById:j,isFetchingUserById:C,setNewMessages:E,addNewMessage:h,onSelectUser:L,onDeleteUser:S,refetchUsers:w,onResetSelectedUser:D}=SV({skipFetchUsersList:!1}),{messagesContainerRef:p}=wV({dependencies:[c,L]});a.useEffect(()=>{u!=null&&u.messages&&E(u==null?void 0:u.messages)},[E,u]),a.useEffect(()=>{i&&i.on("response",d=>{h(d)})},[h,i]);const U=d=>r(d.target.value),B=d=>{d.preventDefault(),A===V?t(!0):(t(!1),f.error("Incorrect password"))},M=()=>o(d=>!d),y=a.useMemo(()=>c.filter(d=>d.receiver===(s==null?void 0:s.userId)||d.sender===(s==null?void 0:s.userId)),[c,s==null?void 0:s.userId]),R=j||C;return e.jsx(aV,{children:n?e.jsxs(oV,{children:[e.jsxs("div",{className:O.headButtons,children:[e.jsx("button",{onClick:M,children:e.jsx(mV,{size:"1.5em"})}),e.jsx("button",{onClick:w,children:e.jsx(hV,{size:"1.3em"})})]}),e.jsxs("div",{className:O.inner,children:[e.jsx(TV,{onSelectUser:L,onDeleteUser:S,isOpenUsersList:l,onResetSelectedUser:D,usersList:g==null?void 0:g.users,selectedUser:s}),e.jsx("div",{className:O.chat,children:R?e.jsx(rV,{children:e.jsx(iV,{})}):e.jsxs(e.Fragment,{children:[e.jsx(cV,{messages:y,selectedUser:s,ref:p}),s&&e.jsx(vV,{socket:i,receiver:s==null?void 0:s.userId})]})})]})]}):e.jsx(JV,{onChangePass:U,value:A,onLogin:B})})},MA=()=>e.jsx(HV,{});export{MA as default};
